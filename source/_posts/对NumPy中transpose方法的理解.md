---
title: 对NumPy中transpose方法的理解
id: understanding-of-transpose-in-numpy
date: 2019-09-10 11:47:56
updated: 2019-09-10 11:47:56
categories:
  - 人类的本质是复读机
tags:
  - python
---
NumPy中有个方法叫做`transport`，用于对数组进行转置或者说轴对换。

通常来说，一维数组不需要转置，因为它只有一个轴。

二维数组因为只有两个轴，它的转置也很简单，直接两个轴对调，在NumPy中`arr.T` 就能得到，结果的规律一眼就能看出。

```
[In]  arr2d = np.arange(15).reshape(3, 5)
      arr2d
[out] array([[ 0,  1,  2,  3,  4],
             [ 5,  6,  7,  8,  9],
             [10, 11, 12, 13, 14]])
[In]  arr2d.T
[Out] array([[ 0,  5, 10],
             [ 1,  6, 11],
             [ 2,  7, 12],
             [ 3,  8, 13],
             [ 4,  9, 14]])
```

而三维及以上的高维数组，想要进行转置就只能通过`transport`方法指定轴进行置换。

<!-- more -->

比如我们先初始化一个三维数组：
```
[In]  arr3d = np.arange(16).reshape((2, 2, 4))
      arr3d
[Out] array([[[ 0,  1,  2,  3],
              [ 4,  5,  6,  7]],

             [[ 8,  9, 10, 11],
              [12, 13, 14, 15]]])
```
然后指定需要转换的轴：
```
[In] arr3d.transpose((1, 0, 2))
```
这句代码是什么意思呢？

原来的轴我们按位置顺序给他们分别编号为0号轴，1号轴，2号轴，所以原来的轴是 (0, 1, 2)。

而 (1, 0, 2) 表示原来的1号轴现在要放到第0号位置，原来的0号轴现在要放到第1号位置，0号轴和1号轴的位置互换了，2号轴的位置保持不变。

下面是转置的结果：
```
[Out] array([[[ 0,  1,  2,  3],
              [ 8,  9, 10, 11]],

             [[ 4,  5,  6,  7],
              [12, 13, 14, 15]]])
```
嗯......看起来似乎有点规律，这个结果是怎么得到的呢？

回忆一下高中的数学知识，我们不是学过xyz轴坐标系吗，我们可以把原来的0号轴当做x轴，1号轴当做y轴，2号轴当做z轴。

想象在由xyz轴组成的一个立体空间中，有一个小球，这个小球的在空间中存在一个位置坐标，还有一个本身的值，比如值为8的那个小球，它在原数组中是第2个数组里的第1个数组里的第1个，所以位置坐标是 (2, 1, 1)，即x=2，y=1，z=1。

而现在坐标轴变换了，原来的x轴现在要当做y轴来看，原来的y轴要当做x轴来看，原来空间中球的位置并没有变化，但是描述空间位置的方式要变了。所以原来的x=2变成了x=1，原来的y=1变成了y=2，x和y交换了值，现在的位置坐标要写作 (1, 2, 1)，所以置换后的数组了，8被放到了第1个数组里的第2个数组里的第1个，其他元素以此类推。

最后，无论是通过`.T`方式还是`transpose`方法还是`swapaxes`方法，返回的都是新数组对象，源数据还是转置前的数据。
```
[In]  arr3d = np.arange(24).reshape((2, 3, 4))
      arr3d
[Out] array([[[ 0,  1,  2,  3],
              [ 4,  5,  6,  7],
              [ 8,  9, 10, 11]],

             [[12, 13, 14, 15],
              [16, 17, 18, 19],
              [20, 21, 22, 23]]])
[In]  arr3d.transpose((2, 0, 1))
[Out] array([[[ 0,  4,  8],
              [12, 16, 20]],

             [[ 1,  5,  9],
              [13, 17, 21]],

             [[ 2,  6, 10],
              [14, 18, 22]],

             [[ 3,  7, 11],
              [15, 19, 23]]])
[In]  arr3d
[Out] array([[[ 0,  1,  2,  3],
              [ 4,  5,  6,  7],
              [ 8,  9, 10, 11]],

             [[12, 13, 14, 15],
              [16, 17, 18, 19],
              [20, 21, 22, 23]]])
```
